# ğŸ›¡ï¸ ä»£ç è´¨é‡çš„â€œåŸƒç™¸æ–¯â€ï¼šä¸ºä»€ä¹ˆä½ çš„é¡¹ç›®éœ€è¦è¿™é¢æ›´æ‡‚ä¸šåŠ¡çš„ ESLint ç¥ç›¾ï¼Ÿ

åœ¨å‰ç«¯é¡¹ç›®çš„é•¿æœŸç»´æŠ¤ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„ç—›ç‚¹ï¼šä»£ç èƒ½è·‘ï¼Œä½†â€œå‘³é“â€ä¸å¯¹ã€‚

è™½ç„¶æˆ‘ä»¬å·²ç»æœ‰äº† ESLint æ ‡å‡†è§„åˆ™ã€Prettier æ ¼å¼åŒ–ï¼Œç”šè‡³å¼•å…¥äº† SonarJS è¿™æ ·ä¸¥æ ¼çš„è´¨é‡æ£€æµ‹å·¥å…·ï¼Œä½†åœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ï¼ˆç‰¹åˆ«æ˜¯å¤§å‹å¤æ‚åº”ç”¨ï¼‰ä¸­ï¼Œé€šç”¨çš„è§„åˆ™å¾€å¾€æ˜¾å¾—â€œç¬¨é‡â€â€”â€”è¦ä¹ˆå¤ªå®½æ³›èµ·ä¸åˆ°çº¦æŸä½œç”¨ï¼Œè¦ä¹ˆå¤ªæ­»æ¿å¯¼è‡´æ»¡å± `// eslint-disable`ã€‚

ä¸ºäº†è§£å†³è¿™äº›â€œç°æœ‰è§„åˆ™æ— æ³•æ»¡è¶³çš„ç‰¹å®šéœ€æ±‚â€ï¼Œæˆ‘å¼€å‘äº† **[eslint-plugin-aegis](https://github.com/LLLaiYoung/eslint-plugin-aegis)**ã€‚

**Aegis (åŸƒç™¸æ–¯)** æ˜¯å¸Œè…Šç¥è¯ä¸­é›…å…¸å¨œå’Œå®™æ–¯æŒæœ‰çš„ç¥ç›¾ï¼Œè±¡å¾ç€ä¿æŠ¤ã€æƒå¨ä¸æ™ºæ…§ã€‚æˆ‘å¸Œæœ›è¿™ä¸ªæ’ä»¶èƒ½åƒ Aegis ä¸€æ ·ï¼Œæˆä¸ºå®ˆæŠ¤ä»£ç è´¨é‡çš„ä¸€é“é˜²çº¿ã€‚

## ğŸ’¡ èƒŒæ™¯ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ

æ—¢ç„¶ç¤¾åŒºé‡Œå·²ç»æœ‰å‡ åƒä¸ªæ’ä»¶äº†ï¼Œä¸ºä»€ä¹ˆè¦é€ è¿™ä¸ªè½®å­ï¼Ÿ

æ ¸å¿ƒåŸå› åªæœ‰ä¸€ä¸ªï¼š**çµæ´»æ€§ä¸ä¸šåŠ¡åœºæ™¯çš„æ·±åº¦ç»“åˆ**ã€‚

å¾ˆå¤šé€šç”¨è§„åˆ™åœ¨è®¾è®¡æ—¶ï¼Œå¾ˆéš¾é¡¾åŠåˆ°å…·ä½“çš„ä¸šåŠ¡ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼š

- **é‡å¤å­—ç¬¦ä¸²æ£€æµ‹**ï¼šé€šç”¨è§„åˆ™ä¼šæŠŠæ‰€æœ‰é‡å¤å­—ç¬¦ä¸²éƒ½æªå‡ºæ¥ã€‚ä½†åœ¨åšå›½é™…åŒ–ï¼ˆi18nï¼‰æ—¶ï¼Œ`t('confirm')` å‡ºç°å‡ åæ¬¡æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œå¼ºåˆ¶æå–å¸¸é‡åè€Œé™ä½äº†å¯è¯»æ€§ã€‚
- **é­”æ³•æ•°å­—**ï¼šé€šç”¨è§„åˆ™ç¦æ­¢æ‰€æœ‰æ•°å­—ã€‚ä½†åœ¨å†™ CSS-in-JS æˆ–é…ç½® UI å¸ƒå±€æ—¶ï¼Œ`exclude: ['width', 'opacity']` è¿™ç§ç®€å•çš„å¿½ç•¥åå•å¾€å¾€ä¸å¤Ÿç”¨ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¼ºå¤§çš„æ­£åˆ™åŒ¹é…æ¥å¿½ç•¥ä¸€ç±»å±æ€§ã€‚
- **å¤æ‚å¯¹è±¡ç±»å‹**ï¼šè™½ç„¶ TS å…·å¤‡å¼ºå¤§çš„æ¨å¯¼èƒ½åŠ›ï¼Œä½†åœ¨é¢å¯¹å¤æ‚å¯¹è±¡æ—¶ï¼Œ**ç¼ºä¹æ˜¾å¼å®šä¹‰çš„éšå¼æ¨å¯¼**æˆ–**è¿‡äºè‡ƒè‚¿çš„å†…è”ç±»å‹ï¼ˆInline Type Literalï¼‰** ä¼šè®©ä»£ç å¥‘çº¦å˜å¾—æ¨¡ç³Šä¸”éš¾ä»¥å¤ç”¨ï¼Œæ˜¾è‘—å¢åŠ é¡¹ç›®çš„ç»´æŠ¤éš¾åº¦ã€‚

`eslint-plugin-aegis` å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›ç»†å¾®ä½†å½±å“æ·±è¿œçš„ç—›ç‚¹è€Œç”Ÿã€‚

---

## ğŸš€ æ ¸å¿ƒèƒ½åŠ›æ¦‚è§ˆ

### 1. çµæ´»å¯æ§çš„é‡å¤å­—ç¬¦ä¸²æ£€æµ‹ï¼š`no-duplicate-string`

> **ç—›ç‚¹**ï¼š`sonarjs/no-duplicate-string` å¾ˆå¥½ï¼Œä½†å®ƒâ€œæ€ä¼¤åŠ›â€å¤ªå¤§äº†ã€‚æœ‰æ—¶å€™æˆ‘åªæ˜¯åœ¨è°ƒç”¨æ‰“ç‚¹å‡½æ•°æˆ–è€…å›½é™…åŒ–å‡½æ•°ï¼Œå®ƒä¹ŸæŠ¥é”™ã€‚

Aegis çš„å»é‡è§„åˆ™æ”¯æŒäº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼š

- **ğŸ¯ åŸºäºä¸Šä¸‹æ–‡çš„å¿½ç•¥**ï¼šæ”¯æŒé…ç½® `ignorePatterns` æ­£åˆ™ã€‚ä¸ä»…å¯ä»¥å¿½ç•¥ç‰¹å®šæ ¼å¼çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ URLã€CSS å•ä½ï¼‰ï¼Œ**æ›´å¼ºå¤§çš„æ˜¯å®ƒæ˜¯å¯ä»¥å¿½ç•¥ç‰¹å®šå‡½æ•°è°ƒç”¨ä¸­çš„å­—ç¬¦ä¸²**ã€‚
  - _åœºæ™¯_ï¼š`t('submit')` å’Œ `track('submit')` ä¸­çš„ `'submit'` è™½ç„¶é‡å¤ï¼Œä½†åªè¦é…ç½®æ­£åˆ™åŒ¹é… `t` å’Œ `track` å‡½æ•°åï¼Œå°±èƒ½è‡ªåŠ¨å¿½ç•¥è¿™äº›è°ƒç”¨ä¸­çš„å­—ç¬¦ä¸²ï¼Œæ— éœ€æ‰‹åŠ¨ disableã€‚
- **ğŸ§© ç²¾å‡†é¿è®©ç±»å‹å®šä¹‰**ï¼šè‡ªåŠ¨å¿½ç•¥ TypeScript çš„å­—é¢é‡ç±»å‹å®šä¹‰ï¼ˆå¦‚ `type Status = 'active' | 'active'`ï¼‰ï¼Œè¿™é€šå¸¸æ˜¯åˆæ³•çš„ä¸šåŠ¡å®šä¹‰ã€‚

#### é…ç½®é¡¹ (Options)

| å±æ€§                   | ç±»å‹       | é»˜è®¤å€¼ | è¯´æ˜                                                         |
| :--------------------- | :--------- | :----- | :----------------------------------------------------------- |
| `threshold`            | `integer`  | `2`    | é‡å¤æ¬¡æ•°é˜ˆå€¼ã€‚è¾¾åˆ°è¯¥å€¼æ—¶æŠ¥é”™ã€‚                               |
| `minLength`            | `integer`  | `5`    | è§¦å‘æ£€æŸ¥çš„å­—ç¬¦ä¸²æœ€å°é•¿åº¦ã€‚                                   |
| `ignoreStrings`        | `string[]` | `[]`   | ç²¾ç¡®åŒ¹é…å¿½ç•¥çš„å­—ç¬¦ä¸²åˆ—è¡¨ã€‚                                   |
| `ignorePatterns`       | `string[]` | `[]`   | æ­£åˆ™è¡¨è¾¾å¼åˆ—è¡¨ï¼ŒåŒ¹é…çš„å­—ç¬¦ä¸²æˆ–**æ‰€åœ¨çš„å‡½æ•°å**å°†è¢«å¿½ç•¥ã€‚     |
| `ignoreTSLiteralTypes` | `boolean`  | `true` | æ˜¯å¦å¿½ç•¥ TypeScript çš„å­—é¢é‡ç±»å‹ (ä¾‹å¦‚ `type T = 'draft'`)ã€‚ |

#### ç¤ºä¾‹é…ç½®

```javascript
"aegis/no-duplicate-string": ["error", {
  "threshold": 2,
  "minLength": 2,
  "ignoreStrings": [
    "application/json", // å¸¸è§ MIME
    "YYYY-MM-DD" // æ—¥æœŸæ ¼å¼
  ],
  "ignorePatterns": [
    "^/", // è·¯å¾„
    "^http(s)?://", // URL
    "^#([0-9A-Fa-f]{3,6})$", // HEX é¢œè‰²
    "^[0-9]+(px|rem|em|vh|vw|%)$", // CSS å•ä½
    "^t$" // å¿½ç•¥å›½é™…åŒ–å‡½æ•° t('...') ä¸­çš„å­—ç¬¦ä¸²
  ]
}]
```

### 2. æ‹’ç»éšå¼é»‘ç›’ï¼š`no-implicit-complex-object`

> **ç—›ç‚¹**ï¼šæ¥æ‰‹è€ä»£ç æ—¶ï¼Œçœ‹åˆ° `const config = { ...50ä¸ªå±æ€§... }` ä¸”æ²¡æœ‰ç±»å‹å®šä¹‰ï¼Œæƒ³çŸ¥é“è¿™ä¸ªå¯¹è±¡åˆ°åº•é•¿ä»€ä¹ˆæ ·ï¼Œåªèƒ½é çŒœæˆ–è€…çœ‹èµ‹å€¼ã€‚è€Œä¸”åœ¨ Vue 3 ä¸­ï¼Œä¸æ˜¾å¼å®šä¹‰æ³›å‹çš„ `ref` å¾€å¾€ä¼šé™ä½ç±»å‹æç¤ºçš„ç›´è§‚æ€§ã€‚

è¿™ä¸ªè§„åˆ™å¼ºåˆ¶è¦æ±‚ï¼š**å½“å¯¹è±¡å­—é¢é‡çš„å±æ€§è¶…è¿‡ä¸€å®šæ•°é‡ï¼ˆé»˜è®¤ 2 ä¸ªï¼‰æ—¶ï¼Œå¿…é¡»æ˜¾å¼å®šä¹‰ Interface æˆ– Typeã€‚**

è¿™ä¸ä»…ä»…æ˜¯ä¸ºäº† TS ç±»å‹æ£€æŸ¥ï¼Œæ›´æ˜¯ä¸ºäº†**ä»£ç å³æ–‡æ¡£**ã€‚

- **âš¡ï¸ Vue 3 å‹å¥½**ï¼šè‡ªåŠ¨è¯†åˆ« `ref()` å’Œ `reactive()`ã€‚
- **ğŸ”§ æ¸è¿›å¼**ï¼šå¯ä»¥é€šè¿‡ `propertyThreshold` è°ƒæ•´é˜ˆå€¼ï¼Œé€æ­¥æ”¶ç´§æ ‡å‡†ã€‚
- **ğŸ“¥ å‡½æ•°å‚æ•°æ”¯æŒ**ï¼šä¸ä»…æ£€æŸ¥å˜é‡èµ‹å€¼ï¼Œè¿˜ä¼šè‡ªåŠ¨æ£€æŸ¥å‡½æ•°å‚æ•°ä¸­çš„å¤æ‚å†…è”ç±»å‹ï¼ˆå¦‚ `function(user: { name: string, age: number })`ï¼‰ã€‚

#### é…ç½®é¡¹ (Options)

| å±æ€§                 | ç±»å‹       | é»˜è®¤å€¼  | è¯´æ˜                                                       |
| :------------------- | :--------- | :------ | :--------------------------------------------------------- |
| `propertyThreshold`  | `integer`  | `2`     | å±æ€§æ•°é‡é˜ˆå€¼ã€‚å½“å¯¹è±¡å±æ€§è¾¾åˆ°è¯¥å€¼æ—¶ä¸”æœªæ˜¾å¼å®šä¹‰ç±»å‹æ—¶æŠ¥é”™ã€‚ |
| `ignoreVue3Wrappers` | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥ Vue 3 çš„ `ref()` å’Œ `reactive()` åŒ…è£…å¯¹è±¡ã€‚       |
| `ignorePatterns`     | `string[]` | `[]`    | æ­£åˆ™è¡¨è¾¾å¼åˆ—è¡¨ï¼ŒåŒ¹é…çš„å˜é‡åå°†è¢«å¿½ç•¥ã€‚                     |

#### ç¤ºä¾‹é…ç½®

```javascript
"aegis/no-implicit-complex-object": ["error", {
  "propertyThreshold": 2,
  "ignorePatterns": [".*Rules$"]
}]
```

```typescript
// âŒ Error: å¤æ‚å¯¹è±¡æœªå®šä¹‰ç±»å‹
const user = { name: "Li", age: 18, role: "admin", dept: "IT" };

// âœ… Pass: æ˜¾å¼å¥‘çº¦ï¼Œç»“æ„æ¸…æ™°
const user: IUser = { name: "Li", age: 18, role: "admin", dept: "IT" };
```

### 3. ä¸¥è°¨çš„é­”æ³•æ•°å­—ï¼š`no-magic-numbers-strict`

> **ç—›ç‚¹**ï¼šåŸç”Ÿ `no-magic-numbers` å¾ˆéš¾ç”¨ã€‚åœ¨ UI å¼€å‘ä¸­ï¼Œ`width: 100` æˆ– `opacity: 0.5` éƒ½è¦æå–å¸¸é‡å®åœ¨å¤ªç¹çã€‚

Aegis å¤åˆ»å¹¶å¢å¼ºäº†è¿™ä¸€è§„åˆ™ï¼ŒåŠ å…¥äº†å¼ºå¤§çš„**æ­£åˆ™è¿‡æ»¤**èƒ½åŠ›ï¼š

- **ğŸ¨ å±æ€§åæ­£åˆ™è¿‡æ»¤**ï¼šé€šè¿‡ `ignorePropertyPatterns`ï¼Œä½ å¯ä»¥å¿½ç•¥ `width`, `minHeight`, `flexGrow` ç”šè‡³æ˜¯æ‰€æœ‰ä»¥ `Cls` ç»“å°¾çš„å±æ€§ä¸­çš„æ•°å­—ã€‚
- **âš™ï¸ å‡½æ•°è°ƒç”¨æ­£åˆ™è¿‡æ»¤**ï¼š`setTimeout(fn, 500)` ä¸­çš„ `500` æ˜¯é­”æ³•æ•°å­—å—ï¼Ÿä¹Ÿè®¸æ˜¯ï¼Œä½†åœ¨è¿™ç§é€šç”¨å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›æ”¾è¡Œã€‚Aegis å…è®¸ä½ é€šè¿‡æ­£åˆ™å¿½ç•¥ç‰¹å®šå‡½æ•°ï¼ˆå¦‚ `setTimeout`, `Date`ï¼‰çš„å‚æ•°ã€‚

#### é…ç½®é¡¹ (Options)

| å±æ€§                            | ç±»å‹       | é»˜è®¤å€¼  | è¯´æ˜                                             |
| :------------------------------ | :--------- | :------ | :----------------------------------------------- |
| `ignore`                        | `number[]` | `[]`    | å¿½ç•¥çš„å…·ä½“æ•°å­—åˆ—è¡¨ã€‚                             |
| `detectObjects`                 | `boolean`  | `false` | æ˜¯å¦æ£€æµ‹å¯¹è±¡å±æ€§ä¸­çš„æ•°å­—ã€‚                       |
| `enforceConst`                  | `boolean`  | `false` | æ˜¯å¦å¼ºåˆ¶è¦æ±‚å˜é‡å£°æ˜ä½¿ç”¨ `const`ã€‚               |
| `ignoreArrayIndexes`            | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥æ•°ç»„ç´¢å¼• `arr[0]`ã€‚                      |
| `ignoreEnums`                   | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥ `enum` å®šä¹‰ä¸­çš„æ•°å­—ã€‚                   |
| `ignoreTypeIndexes`             | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥ TS ç±»å‹ç´¢å¼• `Data[0]`ã€‚                 |
| `ignoreNumericLiteralTypes`     | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥ TS æ•°å­—å­—é¢é‡ç±»å‹ã€‚                     |
| `ignoreReadonlyClassProperties` | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥ç±»ä¸­çš„ `readonly` å±æ€§åˆå§‹å€¼ã€‚           |
| `ignoreDefaultValues`           | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥å‚æ•°é»˜è®¤å€¼ä¸­çš„æ•°å­—ã€‚                     |
| `ignoreClassFieldInitialValues` | `boolean`  | `false` | æ˜¯å¦å¿½ç•¥ç±»å­—æ®µåˆå§‹å€¼ã€‚                           |
| `ignorePropertyPatterns`        | `string[]` | `[]`    | æ­£åˆ™è¡¨è¾¾å¼åˆ—è¡¨ï¼ŒåŒ¹é…çš„å¯¹è±¡å±æ€§åå°†è¢«å¿½ç•¥ã€‚       |
| `ignoreCalleePatterns`          | `string[]` | `[]`    | æ­£åˆ™è¡¨è¾¾å¼åˆ—è¡¨ï¼Œä½œä¸ºè¿™äº›å‡½æ•°å‚æ•°çš„æ•°å­—å°†è¢«å¿½ç•¥ã€‚ |

#### ç¤ºä¾‹é…ç½®

```javascript
"aegis/no-magic-numbers-strict": ["error", {
  "ignore": [-1, 0, 1, 2],
  "ignoreArrayIndexes": true,
  "ignoreTypeIndexes": true,
  "ignoreEnums": true,
  "detectObjects": true,
  "enforceConst": true,
  "ignorePropertyPatterns": ["^width$|Width$"],
  "ignoreCalleePatterns": ["^(Date|setTimeout|setInterval|delay)$"]
}]
```

---

## ğŸ›  å¿«é€Ÿå¼€å§‹

æ’ä»¶å·²å‘å¸ƒè‡³ npmï¼Œæ”¯æŒ ESLint Flat Configã€‚

**å®‰è£…**

```bash
npm install eslint-plugin-aegis --save-dev
# or
yarn add eslint-plugin-aegis -D
```

**é…ç½®**

åœ¨ `eslint.config.js` ä¸­å¼•å…¥å¹¶é…ç½®ï¼š

```javascript
import aegis from "eslint-plugin-aegis";

export default [
  // 1. ä½¿ç”¨æ¨èé…ç½® (å¼€ç®±å³ç”¨)
  aegis.configs.recommended,

  // 2. æˆ–è€…æŒ‰éœ€æ·±åº¦å®šåˆ¶
  {
    plugins: {
      aegis,
    },
    rules: {
      // æ£€æµ‹é‡å¤å­—ç¬¦ä¸²
      "aegis/no-duplicate-string": [
        "error",
        {
          threshold: 2, // é˜ˆå€¼
          minLength: 2, // æœ€å°æ£€æµ‹é•¿åº¦
          ignoreStrings: [], // å¿½ç•¥çš„å­—ç¬¦ä¸²åˆ—è¡¨
          ignorePatterns: ["^t$", "^track$"], // å¿½ç•¥ i18n å’ŒåŸ‹ç‚¹å‡½æ•°
        },
      ],
      // æ£€æµ‹é­”æ³•æ•°å­—
      "aegis/no-magic-numbers-strict": [
        "error",
        {
          ignore: [-1, 0, 1, 2], // å¿½ç•¥çš„é­”æ³•æ•°å­—
          ignoreEnums: true, // å¿½ç•¥æšä¸¾å®šä¹‰
          ignoreTypeIndexes: true, // å¿½ç•¥ç±»å‹ç´¢å¼•
          ignoreArrayIndexes: true, // å¿½ç•¥æ•°ç»„ç´¢å¼•
          detectObjects: true, // æ£€æµ‹å¯¹è±¡
          enforceConst: true, // å…è®¸ä½¿ç”¨ const å£°æ˜é­”æ³•æ•°å­—ï¼Œé const å£°æ˜çš„ä¼šæç¤º
          ignorePropertyPatterns: ["^width$|Width$"], // å¿½ç•¥çš„å±æ€§
          ignoreCalleePatterns: ["^(Date|setTimeout|delay)$"], // å¿½ç•¥çš„è°ƒç”¨
        },
      ],
      // æ£€æµ‹éšå¼å¤æ‚å¯¹è±¡
      "aegis/no-implicit-complex-object": [
        "error",
        {
          propertyThreshold: 2,
          ignorePatterns: [".*Rules$"],
        },
      ],
    },
  },
];
```

## ç»“è¯­

å·¥å…·çš„ç›®çš„æ˜¯æœåŠ¡äºäººï¼Œè€Œä¸æ˜¯æŸç¼šäººã€‚`eslint-plugin-aegis` çš„åˆè¡·å°±æ˜¯åœ¨**ä¸¥æ ¼çš„ä»£ç è´¨é‡è¦æ±‚**å’Œ**æµç•…çš„å¼€å‘ä½“éªŒ**ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ã€‚

å¦‚æœä½ ä¹Ÿåœ¨è¢«é€šç”¨çš„ Lint è§„åˆ™è¯¯ä¼¤ï¼Œæˆ–è€…å¸Œæœ›å¯¹å›¢é˜Ÿä»£ç é£æ ¼æœ‰æ›´ç»†ç²’åº¦çš„æŒæ§ï¼Œæ¬¢è¿å°è¯•ä¸€ä¸‹ Aegisï¼Œä¹Ÿæ¬¢è¿æ¥ GitHub æ Issue æˆ– PRï¼Œå…±åŒå®Œå–„è¿™é¢â€œç¥ç›¾â€ï¼

ğŸ”— **GitHub**: [https://github.com/LLLaiYoung/eslint-plugin-aegis](https://github.com/LLLaiYoung/eslint-plugin-aegis)

---

_Let's build better code, together._
